# Angular 13 Event Handling - Comprehensive Notes

## Overview

Event handling in Angular allows components to respond to user interactions and system events. Angular provides a declarative way to bind event handlers directly in templates and offers powerful features for managing event behavior.

## Basic Event Binding Syntax

```typescript
// Template syntax
<button (click)="handleClick()">Click me</button>
<input (keyup)="onKeyUp($event)">
```

## 1. The `$event` Object

The `$event` object provides access to the native DOM event and its properties.

### Usage in Templates

```typescript
// Component Template
<input (keyup)="onKeyUp($event)" placeholder="Type something">
<button (click)="onClick($event)">Click me</button>
<form (submit)="onSubmit($event)">
  <input type="text" name="username">
  <button type="submit">Submit</button>
</form>
```

### Component Methods

```typescript
// Component Class
export class EventComponent {
  
  onKeyUp(event: KeyboardEvent) {
    console.log('Key pressed:', event.key);
    console.log('Input value:', (event.target as HTMLInputElement).value);
    console.log('Key code:', event.keyCode);
  }
  
  onClick(event: MouseEvent) {
    console.log('Click coordinates:', event.clientX, event.clientY);
    console.log('Target element:', event.target);
    console.log('Event type:', event.type);
  }
  
  onSubmit(event: SubmitEvent) {
    console.log('Form submitted');
    console.log('Form data:', new FormData(event.target as HTMLFormElement));
  }
}
```

### Event Object Properties

```typescript
// Common event properties
onGenericEvent(event: Event) {
  console.log('Event type:', event.type);
  console.log('Target element:', event.target);
  console.log('Current target:', event.currentTarget);
  console.log('Timestamp:', event.timeStamp);
}

// Mouse event specific properties
onMouseEvent(event: MouseEvent) {
  console.log('Button clicked:', event.button); // 0=left, 1=middle, 2=right
  console.log('Coordinates:', event.clientX, event.clientY);
  console.log('Ctrl key pressed:', event.ctrlKey);
  console.log('Shift key pressed:', event.shiftKey);
}

// Keyboard event specific properties
onKeyboardEvent(event: KeyboardEvent) {
  console.log('Key:', event.key);
  console.log('Code:', event.code);
  console.log('Alt key pressed:', event.altKey);
  console.log('Ctrl key pressed:', event.ctrlKey);
}
```

## 2. `preventDefault()` Method

Prevents the default browser behavior for an event.

### Common Use Cases

```typescript
// Component Template
<form (submit)="onSubmit($event)">
  <input type="email" [(ngModel)]="email" required>
  <button type="submit">Submit</button>
</form>

<a href="https://example.com" (click)="onLinkClick($event)">Custom Link</a>

<div (contextmenu)="onRightClick($event)">Right click me</div>
```

```typescript
// Component Class
export class PreventDefaultComponent {
  email: string = '';
  
  onSubmit(event: SubmitEvent) {
    event.preventDefault(); // Prevent form submission
    
    // Custom form validation
    if (this.email.includes('@')) {
      console.log('Valid email:', this.email);
      // Proceed with custom submission logic
    } else {
      console.log('Invalid email');
    }
  }
  
  onLinkClick(event: MouseEvent) {
    event.preventDefault(); // Prevent navigation
    
    // Custom navigation logic
    console.log('Custom link handling');
    // Maybe show a modal or perform other actions
  }
  
  onRightClick(event: MouseEvent) {
    event.preventDefault(); // Prevent context menu
    
    // Show custom context menu
    console.log('Custom right-click behavior');
  }
}
```

### Practical Examples

```typescript
// Prevent form submission on Enter key
onKeyDown(event: KeyboardEvent) {
  if (event.key === 'Enter') {
    event.preventDefault();
    console.log('Enter key prevented');
  }
}

// Prevent drag and drop
onDragOver(event: DragEvent) {
  event.preventDefault();
}

onDrop(event: DragEvent) {
  event.preventDefault();
  // Handle custom drop logic
}
```

## 3. `stopPropagation()` Method

Stops the event from bubbling up to parent elements.

### Event Bubbling Example

```typescript
// Component Template
<div (click)="onParentClick()" class="parent">
  Parent Div
  <div (click)="onChildClick($event)" class="child">
    Child Div
    <button (click)="onButtonClick($event)">Button</button>
  </div>
</div>
```

```typescript
// Component Class
export class StopPropagationComponent {
  
  onParentClick() {
    console.log('Parent clicked');
  }
  
  onChildClick(event: MouseEvent) {
    console.log('Child clicked');
    // Uncomment to stop propagation
    // event.stopPropagation();
  }
  
  onButtonClick(event: MouseEvent) {
    console.log('Button clicked');
    event.stopPropagation(); // Prevent parent handlers from executing
  }
}
```

### Practical Use Cases

```typescript
// Modal with overlay
onOverlayClick(event: MouseEvent) {
  this.closeModal();
}

onModalContentClick(event: MouseEvent) {
  event.stopPropagation(); // Prevent modal from closing when clicking content
}

// Dropdown menu
onDropdownClick(event: MouseEvent) {
  event.stopPropagation(); // Prevent document click handler from closing dropdown
}
```

## 4. Custom Events with EventEmitter

Create and emit custom events for component communication.

### Parent-Child Communication

```typescript
// Child Component
import { Component, EventEmitter, Output } from '@angular/core';

@Component({
  selector: 'app-child',
  template: `
    <button (click)="sendMessage()">Send Message</button>
    <input [(ngModel)]="inputValue" (keyup.enter)="sendValue()">
  `
})
export class ChildComponent {
  @Output() messageEvent = new EventEmitter<string>();
  @Output() valueChange = new EventEmitter<string>();
  
  inputValue: string = '';
  
  sendMessage() {
    this.messageEvent.emit('Hello from child!');
  }
  
  sendValue() {
    this.valueChange.emit(this.inputValue);
  }
}
```

```typescript
// Parent Component
@Component({
  selector: 'app-parent',
  template: `
    <app-child 
      (messageEvent)="handleMessage($event)"
      (valueChange)="handleValueChange($event)">
    </app-child>
    <p>Message: {{ message }}</p>
    <p>Value: {{ value }}</p>
  `
})
export class ParentComponent {
  message: string = '';
  value: string = '';
  
  handleMessage(message: string) {
    this.message = message;
  }
  
  handleValueChange(value: string) {
    this.value = value;
  }
}
```

### Custom Event with Data

```typescript
// Custom interface for event data
interface CustomEventData {
  id: number;
  name: string;
  timestamp: Date;
}

@Component({
  selector: 'app-custom-event',
  template: `
    <div *ngFor="let item of items">
      <button (click)="selectItem(item)">{{ item.name }}</button>
    </div>
  `
})
export class CustomEventComponent {
  @Output() itemSelected = new EventEmitter<CustomEventData>();
  
  items = [
    { id: 1, name: 'Item 1' },
    { id: 2, name: 'Item 2' }
  ];
  
  selectItem(item: any) {
    const eventData: CustomEventData = {
      ...item,
      timestamp: new Date()
    };
    this.itemSelected.emit(eventData);
  }
}
```

## 5. Keyboard Events

Handle various keyboard interactions.

### Key Event Types

```typescript
// Component Template
<input 
  (keydown)="onKeyDown($event)"
  (keyup)="onKeyUp($event)"
  (keypress)="onKeyPress($event)"
  placeholder="Type here">

<!-- Specific key bindings -->
<input (keyup.enter)="onEnter()" placeholder="Press Enter">
<input (keyup.escape)="onEscape()" placeholder="Press Escape">
<div (keydown.ctrl.s)="onSave($event)" tabindex="0">Ctrl+S to save</div>
```

```typescript
// Component Class
export class KeyboardEventComponent {
  
  onKeyDown(event: KeyboardEvent) {
    console.log('Key down:', event.key);
    
    // Handle special keys
    switch(event.key) {
      case 'Tab':
        // Handle tab navigation
        break;
      case 'Enter':
        // Handle enter key
        break;
      case 'Escape':
        // Handle escape key
        break;
    }
  }
  
  onKeyUp(event: KeyboardEvent) {
    console.log('Key up:', event.key);
    console.log('Input value:', (event.target as HTMLInputElement).value);
  }
  
  onKeyPress(event: KeyboardEvent) {
    console.log('Key press:', event.key);
    
    // Restrict input to numbers only
    if (!/[0-9]/.test(event.key)) {
      event.preventDefault();
    }
  }
  
  onEnter() {
    console.log('Enter key pressed');
  }
  
  onEscape() {
    console.log('Escape key pressed');
  }
  
  onSave(event: KeyboardEvent) {
    event.preventDefault();
    console.log('Ctrl+S pressed - saving...');
  }
}
```

### Advanced Keyboard Handling

```typescript
// Keyboard shortcuts component
@Component({
  selector: 'app-keyboard-shortcuts',
  template: `
    <div (keydown)="handleKeydown($event)" tabindex="0" class="shortcut-area">
      <p>Try these shortcuts:</p>
      <ul>
        <li>Ctrl+N: New</li>
        <li>Ctrl+S: Save</li>
        <li>Ctrl+Z: Undo</li>
        <li>Delete: Delete</li>
      </ul>
    </div>
  `
})
export class KeyboardShortcutsComponent {
  
  @HostListener('keydown', ['$event'])
  handleKeydown(event: KeyboardEvent) {
    
    // Handle combinations
    if (event.ctrlKey) {
      switch(event.key) {
        case 'n':
          event.preventDefault();
          this.newAction();
          break;
        case 's':
          event.preventDefault();
          this.saveAction();
          break;
        case 'z':
          event.preventDefault();
          this.undoAction();
          break;
      }
    }
    
    // Handle single keys
    switch(event.key) {
      case 'Delete':
        this.deleteAction();
        break;
      case 'F1':
        event.preventDefault();
        this.showHelp();
        break;
    }
  }
  
  newAction() { console.log('New action'); }
  saveAction() { console.log('Save action'); }
  undoAction() { console.log('Undo action'); }
  deleteAction() { console.log('Delete action'); }
  showHelp() { console.log('Help opened'); }
}
```

## 6. Mouse Events

Handle various mouse interactions.

### Mouse Event Types

```typescript
// Component Template
<div class="mouse-area"
     (click)="onClick($event)"
     (dblclick)="onDoubleClick($event)"
     (mousedown)="onMouseDown($event)"
     (mouseup)="onMouseUp($event)"
     (mouseenter)="onMouseEnter($event)"
     (mouseleave)="onMouseLeave($event)"
     (mousemove)="onMouseMove($event)"
     (contextmenu)="onContextMenu($event)">
  <p>Mouse interaction area</p>
  <p>X: {{ mouseX }}, Y: {{ mouseY }}</p>
</div>

<button (click)="toggleHighlight()" 
        [class.highlighted]="isHighlighted">
  Toggle Highlight
</button>
```

```typescript
// Component Class
export class MouseEventComponent {
  mouseX: number = 0;
  mouseY: number = 0;
  isHighlighted: boolean = false;
  
  onClick(event: MouseEvent) {
    console.log('Click at:', event.clientX, event.clientY);
    console.log('Button:', event.button); // 0=left, 1=middle, 2=right
  }
  
  onDoubleClick(event: MouseEvent) {
    console.log('Double click detected');
  }
  
  onMouseDown(event: MouseEvent) {
    console.log('Mouse down');
  }
  
  onMouseUp(event: MouseEvent) {
    console.log('Mouse up');
  }
  
  onMouseEnter(event: MouseEvent) {
    console.log('Mouse entered');
    (event.target as HTMLElement).style.backgroundColor = 'lightblue';
  }
  
  onMouseLeave(event: MouseEvent) {
    console.log('Mouse left');
    (event.target as HTMLElement).style.backgroundColor = 'white';
  }
  
  onMouseMove(event: MouseEvent) {
    this.mouseX = event.clientX;
    this.mouseY = event.clientY;
  }
  
  onContextMenu(event: MouseEvent) {
    event.preventDefault(); // Prevent default context menu
    console.log('Right click detected');
  }
  
  toggleHighlight() {
    this.isHighlighted = !this.isHighlighted;
  }
}
```

### Advanced Mouse Interactions

```typescript
// Drag and drop component
@Component({
  selector: 'app-drag-drop',
  template: `
    <div class="drag-container">
      <div class="draggable" 
           draggable="true"
           (dragstart)="onDragStart($event)"
           (dragend)="onDragEnd($event)">
        Drag me
      </div>
      
      <div class="drop-zone"
           (dragover)="onDragOver($event)"
           (dragleave)="onDragLeave($event)"
           (drop)="onDrop($event)"
           [class.drag-over]="isDragOver">
        Drop here
      </div>
    </div>
  `
})
export class DragDropComponent {
  isDragOver: boolean = false;
  
  onDragStart(event: DragEvent) {
    console.log('Drag started');
    event.dataTransfer?.setData('text/plain', 'dragged data');
  }
  
  onDragEnd(event: DragEvent) {
    console.log('Drag ended');
  }
  
  onDragOver(event: DragEvent) {
    event.preventDefault();
    this.isDragOver = true;
  }
  
  onDragLeave(event: DragEvent) {
    this.isDragOver = false;
  }
  
  onDrop(event: DragEvent) {
    event.preventDefault();
    this.isDragOver = false;
    
    const data = event.dataTransfer?.getData('text/plain');
    console.log('Dropped data:', data);
  }
}
```

## Best Practices

### 1. Type Safety

```typescript
// Use specific event types
onKeyboardEvent(event: KeyboardEvent) { }
onMouseEvent(event: MouseEvent) { }
onFormEvent(event: SubmitEvent) { }

// Type assertion when accessing target
const input = event.target as HTMLInputElement;
const form = event.target as HTMLFormElement;
```

### 2. Event Delegation

```typescript
// Handle multiple similar elements
@Component({
  template: `
    <div (click)="handleClick($event)">
      <button data-action="save">Save</button>
      <button data-action="delete">Delete</button>
      <button data-action="edit">Edit</button>
    </div>
  `
})
export class EventDelegationComponent {
  
  handleClick(event: MouseEvent) {
    const target = event.target as HTMLElement;
    const action = target.dataset['action'];
    
    switch(action) {
      case 'save':
        this.save();
        break;
      case 'delete':
        this.delete();
        break;
      case 'edit':
        this.edit();
        break;
    }
  }
}
```

### 3. Memory Management

```typescript
// Clean up subscriptions and listeners
export class EventComponent implements OnDestroy {
  private subscription?: Subscription;
  
  ngOnInit() {
    // Example subscription
    this.subscription = fromEvent(document, 'keydown')
      .subscribe(event => this.handleGlobalKeydown(event));
  }
  
  ngOnDestroy() {
    this.subscription?.unsubscribe();
  }
}
```

### 4. Performance Considerations

```typescript
// Debounce frequent events
import { debounceTime, fromEvent } from 'rxjs';

ngOnInit() {
  fromEvent(window, 'resize')
    .pipe(debounceTime(300))
    .subscribe(event => this.handleResize(event));
}

// Throttle mouse move events
import { throttleTime } from 'rxjs';

ngOnInit() {
  fromEvent(document, 'mousemove')
    .pipe(throttleTime(16)) // ~60fps
    .subscribe(event => this.handleMouseMove(event));
}
```

## Summary

Angular 13 event handling provides powerful features for creating interactive applications:

- **$event object**: Access to native DOM events and their properties
- **preventDefault()**: Control default browser behavior
- **stopPropagation()**: Manage event bubbling
- **Custom Events**: Component communication via EventEmitter
- **Keyboard Events**: Handle key interactions with specific key bindings
- **Mouse Events**: Comprehensive mouse interaction handling

These features enable rich user interactions while maintaining clean, maintainable code structure.